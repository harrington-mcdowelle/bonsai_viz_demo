<html>
  <head>
    <script language="JavaScript">
      const params = new URLSearchParams(window.location.search);
      const darkMode = params.get("_theme") === "dark";

      function init() {
        const processed_products = document.getElementById("processed_products");
        const projected_missed_products = document.getElementById("projected_missed_products");

        window.addEventListener(
          "message",
          (event) => {
            // convert message to formatted JSON text for display
            const data = JSON.parse(event.data);
            const str = JSON.stringify(data, null, 4);
            const out = document.getElementById("out");
            out.textContent = str;

            // read state out of message and convert units
            const processed_products = data.state["processed_products"];
            const projected_missed_products = data.state["projected_missed_products"];
          },
          false
        );
      }
      init();
    </script>
  </body>
</html>